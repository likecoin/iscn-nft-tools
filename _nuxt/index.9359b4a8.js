import{F as z,v as P,z as K,r as w,q as Q,l as X,o as v,b as p,u as f,A as y,B as D,e as s,C as Y,D as Z,E as ee,h as L,G as I,H as j}from"./entry.58f06460.js";import{h as $,l as te,i as se,j as ae,k as E,t as ne,m as re,p as le,f as oe,d as ie}from"./sync.b7966e74.js";import{u as ue}from"./wallet.36551368.js";var n={},ce=$&&$.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});n.formatMsgSellNFT=n.formatMsgDeleteOffer=n.formatMsgUpdateOffer=n.formatMsgCreateOffer=n.formatMsgBuyNFT=n.formatMsgDeleteListing=n.formatMsgUpdateListing=n.formatMsgCreateListing=n.formatMsgDeleteRoyaltyConfig=n.formatMsgUpdateRoyaltyConfig=n.formatMsgCreateRoyaltyConfig=n.formatMsgBurnNFT=V=n.formatMsgSend=n.formatMsgMintNFT=n.formatMsgUpdateClass=n.formatMsgNewClass=void 0;const b=ce(te),H=z;function fe(t,a,e,r){return{typeUrl:"/likechain.likenft.v1.MsgNewClass",value:{creator:t,parent:{type:1,iscnIdPrefix:a},input:{name:e.name,symbol:e.symbol,description:e.description,uri:e.uri,uriHash:e.uriHash,metadata:H.Buffer.from(JSON.stringify(Object.assign({},e.metadata||{})),"utf8"),config:r||{burnable:!1}}}}}n.formatMsgNewClass=fe;function ge(t,a,e,r){return{typeUrl:"/likechain.likenft.v1.MsgUpdateClass",value:{creator:t,classId:a,input:Object.assign(Object.assign({},e),{config:r||{burnable:!1}})}}}n.formatMsgUpdateClass=ge;function de(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgMintNFT",value:{creator:t,classId:a,id:e.id,input:{uri:e.uri,uriHash:e.uriHash,metadata:H.Buffer.from(JSON.stringify(Object.assign({},e.metadata||{})),"utf8")}}}}n.formatMsgMintNFT=de;function me(t,a,e,r){return{typeUrl:"/cosmos.nft.v1beta1.MsgSend",value:{sender:t,receiver:a,classId:e,id:r}}}var V=n.formatMsgSend=me;function ve(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgBurnNFT",value:{creator:t,classId:a,nftId:e}}}n.formatMsgBurnNFT=ve;function pe(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgCreateRoyaltyConfig",value:{creator:t,classId:a,royaltyConfig:e}}}n.formatMsgCreateRoyaltyConfig=pe;function Me(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgUpdateRoyaltyConfig",value:{creator:t,classId:a,royaltyConfig:e}}}n.formatMsgUpdateRoyaltyConfig=Me;function he(t,a){return{typeUrl:"/likechain.likenft.v1.MsgDeleteRoyaltyConfig",value:{creator:t,classId:a}}}n.formatMsgDeleteRoyaltyConfig=he;function ye(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgCreateListing",value:{creator:t,classId:a,nftId:e,price:b.default.fromString(r),expiration:l?new Date(l):new Date(Date.now()+15552e3)}}}n.formatMsgCreateListing=ye;function Ce(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgUpdateListing",value:{creator:t,classId:a,nftId:e,price:b.default.fromString(r),expiration:l?new Date(l):new Date(Date.now()+15552e3)}}}n.formatMsgUpdateListing=Ce;function _e(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgDeleteListing",value:{creator:t,classId:a,nftId:e}}}n.formatMsgDeleteListing=_e;function ke(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgBuyNFT",value:{creator:t,classId:a,nftId:e,seller:r,price:b.default.fromString(l)}}}n.formatMsgBuyNFT=ke;function Se(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgCreateOffer",value:{creator:t,classId:a,nftId:e,price:b.default.fromString(r),expiration:l?new Date(l):new Date(Date.now()+15552e3)}}}n.formatMsgCreateOffer=Se;function we(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgUpdateOffer",value:{creator:t,classId:a,nftId:e,price:b.default.fromString(r),expiration:l?new Date(l):new Date(Date.now()+15552e3)}}}n.formatMsgUpdateOffer=we;function be(t,a,e){return{typeUrl:"/likechain.likenft.v1.MsgDeleteOffer",value:{creator:t,classId:a,nftId:e}}}n.formatMsgDeleteOffer=be;function Ne(t,a,e,r,l){return{typeUrl:"/likechain.likenft.v1.MsgSellNFT",value:{creator:t,classId:a,nftId:e,buyer:r,price:b.default.fromString(l)}}}n.formatMsgSellNFT=Ne;const Te=s("h1",null,"Send NFT",-1),Ue={key:0,style:{color:"red"}},Fe={key:1,style:{color:"green"}},De=s("hr",null,null,-1),Oe={key:2},Re=s("h2",null,"1. Send NFT",-1),xe=s("p",null,[s("label",null,"Enter default memo (optional)")],-1),Be=s("p",null,[s("label",null,"Upload NFT CSV (list.csv) file: ")],-1),Le={key:0},Ie=s("thead",null,[s("tr",null,[s("td",null,"Class ID"),s("td",null,"Count")])],-1),je=s("br",null,null,-1),$e=["disabled"],Ee={key:3},He=s("thead",null,[s("tr",null,[s("td",null,"Address"),s("td",null,"Class ID"),s("td",null,"Memo"),s("td",null,"Status")])],-1),Ve=["disabled"],We=P({__name:"index",setup(t){const a=ue(),{wallet:e,signer:r}=K(a),{connect:l}=a,d=w(1),N=w(""),k=w(!1),T=w(""),m=w([]),C=w([]),O=Q(()=>m.value.reduce((o,M)=>(o[M.classId]=(o[M.classId]||0)+1,o),{}));X(k,o=>{o&&(N.value="")});async function q(){try{if(k.value=!0,(!e.value||!r.value)&&await l(),!e.value||!r.value)return;if(!m.value.length)throw new Error("NFT data not exists");const o={};for(let u=0;u<Object.keys(O.value).length;u+=1){const c=Object.keys(O.value)[u],F=O.value[c],{nfts:x}=await se({classId:c,owner:e.value,needCount:F});if(o[c]=x,F>o[c].length)throw new Error(`NFT classId: ${c} (own quantity: ${o[c].length}), Will send ${F} counts, NFT not enough!`)}const g=(await ae(r.value)).getSigningStargateClient();if(!g)throw new Error("Signing client not exists");const _=m.value.some(u=>u.memo),{accountNumber:i,sequence:B}=await g.getSequence(e.value),R=await g.getChainId();d.value+=1;const h=[];let U=B;for(let u=0;u<m.value.length;u+=1){const c=m.value[u],F=o[c.classId].splice(0,1),x=V(e.value,c.address,c.classId,F[0].id);if(_){const W=await g.sign(e.value,[x],E(1),c.memo||T.value,{accountNumber:i,sequence:U,chainId:R});C.value[u].status="signed",U+=1;try{const S=ne.TxRaw.encode(W).finish(),J=await g.broadcastTx(S,1e3,1e3);C.value[u].status=`broadcasted ${J.transactionHash}`}catch(S){if(S instanceof re.TimeoutError)C.value[u].status=`broadcasted ${S.txId}`;else throw C.value[u].status=`error ${S.toString()}`,S}}else h.push(x)}if(h.length){const u=await g.signAndBroadcast(e.value,h,E(m.value.length),T.value);for(let c=0;c<m.value.length;c+=1)C.value[c].status=`broadcasted ${u.transactionHash}`}}catch(o){console.error(o),N.value=o.toString()}finally{k.value=!1}}function A(o){var i;if(!(o!=null&&o.target))return;const M=(i=o.target)==null?void 0:i.files;if(!M)return;const[g]=M,_=new FileReader;_.onload=B=>{var R;try{const h=(R=B.target)==null?void 0:R.result;if(typeof h!="string")return;const U=le(h,{columns:!0});m.value=U,C.value=U}catch(h){console.error(h),N.value=h.toString()}},_.readAsText(g)}function G(){oe(ie(C.value),"result.csv","text/csv;charset=utf-8;")}return(o,M)=>{var g,_;return v(),p("div",null,[Te,f(N)?(v(),p("div",Ue,y(f(N)),1)):D("",!0),f(k)?(v(),p("div",Fe," Loading... ")):D("",!0),s("div",null,"Steps "+y(f(d))+" / 2",1),De,f(d)===1?(v(),p("section",Oe,[Re,s("div",null,[xe,Y(s("input",{"onUpdate:modelValue":M[0]||(M[0]=i=>ee(T)?T.value=i:null),placeholder:"default memo"},null,512),[[Z,f(T)]]),Be,(g=f(m))!=null&&g.length?(v(),p("div",Le,[s("pre",null,"Number of NFT data in CSV:"+y((_=f(m))==null?void 0:_.length),1),L(" Summary "),s("table",null,[Ie,s("tbody",null,[(v(!0),p(I,null,j(Object.entries(f(O)),i=>(v(),p("tr",{key:i[0]},[s("td",null,y(i[0]),1),s("td",null,y(i[1]),1)]))),128))])])])):D("",!0),s("input",{type:"file",onChange:A},null,32),je,s("button",{disabled:f(k),style:{"margin-top":"16px"},onClick:q}," Send ",8,$e)])])):D("",!0),f(d)>1?(v(),p("section",Ee,[L(" Result: "),s("table",null,[He,s("tbody",null,[(v(!0),p(I,null,j(f(C),i=>(v(),p("tr",{key:i[0]},[s("td",null,y(i.address),1),s("td",null,y(i.classId),1),s("td",null,y(i.memo),1),s("td",null,y(i.status),1)]))),128))])]),s("button",{disabled:f(k),onClick:G}," Download NFT result csv ",8,Ve)])):D("",!0)])}}});export{We as default};
