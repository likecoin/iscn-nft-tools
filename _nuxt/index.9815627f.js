import{g as F,s as I,r as c,h as K,i as T,o as r,c as i,f as l,t as d,j as h,a as e,k as B,v as V,l as D,F as M,m as R,d as E}from"./entry.ee2dc856.js";import{a as U,t as H,B as W,b as j,p as G}from"./sync.31708ed9.js";import{u as O}from"./wallet.e754ed07.js";import{D as P}from"./index.4dd71626.js";const $=e("h1",null,"Send LIKE",-1),q={key:0,style:{color:"red"}},z={key:1,style:{color:"green"}},J=e("hr",null,null,-1),Q={key:2},X=e("h2",null,"1. Send LIKE",-1),Y=e("p",null,[e("label",null,"Enter default memo (optional)")],-1),Z=e("p",null,[e("label",null,[E("Upload LIKE CSV ( "),e("a",{href:"https://github.com/likecoin/iscn-nft-tools/blob/master/send-like/list_example.csv",target:"_blank"}," list.csv "),E(") file: ")])],-1),ee={key:0},te=e("thead",null,[e("tr",null,[e("td",null,"Address"),e("td",null,"LIKE")])],-1),ne=e("br",null,null,-1),le=["disabled"],se={key:3},de=F({__name:"index",setup(oe){const k=O(),{wallet:p,signer:S}=I(k),{connect:w}=k,_=c(1),g=c(""),f=c(!1),v=c(""),o=c([]),y=c(""),L=K(()=>o.value.reduce((n,s)=>n+Number(s.LIKE),0));T(f,n=>{n&&(g.value="")});async function C(){try{if(f.value=!0,(!p.value||!S.value)&&await w(),!p.value||!S.value)return;if(!o.value.length)throw new Error("NFT data not exists");const s=(await U(S.value)).getSigningStargateClient();if(!s)throw new Error("Signing client not exists");_.value+=1;const a=[];for(let t=0;t<o.value.length;t+=1){const u=o.value[t],b=H.MsgSend.fromPartial({fromAddress:p.value,toAddress:u.address,amount:[{denom:P,amount:`${new W(u.LIKE).shiftedBy(9).toFixed(0)}`}]});a.push(b)}if(a.length){const t=await s.signAndBroadcast(p.value,a.map(u=>({typeUrl:"/cosmos.bank.v1beta1.MsgSend",value:u})),j(o.value.length),v.value);y.value=t.transactionHash}}catch(n){console.error(n),g.value=n.toString()}finally{f.value=!1}}function N(n){var u;if(!(n!=null&&n.target))return;const s=(u=n.target)==null?void 0:u.files;if(!s)return;const[a]=s,t=new FileReader;t.onload=b=>{var x;try{const m=(x=b.target)==null?void 0:x.result;if(typeof m!="string")return;const A=G(m,{columns:!0});o.value=A,y.value=""}catch(m){console.error(m),g.value=m.toString()}},t.readAsText(a)}return(n,s)=>{var a;return r(),i("div",null,[$,l(g)?(r(),i("div",q,d(l(g)),1)):h("",!0),l(f)?(r(),i("div",z," Loading... ")):h("",!0),e("div",null,"Steps "+d(l(_))+" / 2",1),J,l(_)===1?(r(),i("section",Q,[X,e("div",null,[Y,B(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>D(v)?v.value=t:null),placeholder:"default memo"},null,512),[[V,l(v)]]),Z,(a=l(o))!=null&&a.length?(r(),i("div",ee,[e("pre",null,"Number of entries in CSV:"+d(l(o).length),1),e("pre",null,"Total amount:"+d(l(L)),1),e("table",null,[te,e("tbody",null,[(r(!0),i(M,null,R(l(o),t=>(r(),i("tr",{key:t.address},[e("td",null,d(t.address),1),e("td",null,d(t.LIKE),1)]))),128))])])])):h("",!0),e("input",{type:"file",onChange:N},null,32),ne,e("button",{disabled:l(f),style:{"margin-top":"16px"},onClick:C}," Send ",8,le)])])):h("",!0),l(_)>1?(r(),i("section",se," Result: "+d(l(y)),1)):h("",!0)])}}});export{de as default};
